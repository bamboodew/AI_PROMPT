# SQL prompt

## 中文

请帮我检查、并优化SQL代码，以提高可读性和运行效率。

1. 检查整体框架，总结逻辑思路，指出可能存在的不足和风险，提供建议，但不要修改。
2. 删除没有使用到的不必要的字段，可以直接修改。
3. 检查不符合sparkSQL的语法错误，可以直接修改。
4. 子查询、表格、变量字段的别名，请简短而可读，可以直接修改。
5. 最后，输出代码时，在修改行的前一行备注修改的内容，标记[修改]。

## English

Please help me with the following regarding the code. Review and optimize the code to enhance readability and operational efficiency.

1. Examine the overall framework, summarize the logical approach, point out potential deficiencies and risks, and provide suggestions, but do not make any changes.
2. Remove any unnecessary fields that are not used; direct modifications are allowed.
3. Check for syntax errors that do not comply with SparkSQL; direct modifications are allowed.
4. For subqueries, tables, and variable fields, aliases should be concise and readable; direct modifications are allowed.
5. Finally, when outputting the code, comment on the changes made on the line before the modified line, marked with [Modification].
